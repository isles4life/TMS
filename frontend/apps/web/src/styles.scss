/* Global Truckstop-inspired styling + Angular Material theme */
@use 'sass:map';
@use '@angular/material' as mat;
@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700;800&display=swap');

:root {
  /* Light Mode Colors (Default) */
  --ts-red: #d71920;
  --ts-red-dark: #b31218;
  --ts-ink: #0f1115;
  --ts-ink-secondary: #4a4f58;
  --ts-stone: #2f343d;
  --ts-green: #1ea672;
  --ts-amber: #f5a300;
  --ts-surface: #f7f8fa;
  --ts-surface-secondary: #ffffff;
  --ts-page-bg: #f2f3f5;
  --ts-border: #e0e2e8;
  --ts-overlay-bg: rgba(0, 0, 0, 0.5);
  --ts-spacing-sm: 8px;
  --ts-spacing-md: 12px;
  --ts-spacing-lg: 16px;
  --ts-spacing-xl: 24px;
  --ts-spacing-2xl: 32px;
  --ts-spacing-3xl: 48px;
}

/* Dark Mode Colors */
:root.dark-mode {
  --ts-red: #ff4444;
  --ts-red-dark: #dd3333;
  --ts-ink: #e0e0e0;
  --ts-ink-secondary: #b0b0b0;
  --ts-stone: #707070;
  --ts-green: #26d48e;
  --ts-amber: #ffb84d;
  --ts-surface: #2a2f39;
  --ts-surface-secondary: #1e2229;
  --ts-page-bg: #1a1f28;
  --ts-border: #3a3f48;
  --ts-overlay-bg: rgba(0, 0, 0, 0.7);
}

/* Angular Material theme (Truckstop) */
@include mat.core();

$ts-primary: mat.define-palette(mat.$red-palette, 700, 600, 800);
$ts-accent: mat.define-palette(mat.$amber-palette, 600, 500, 700);
$ts-warn: mat.define-palette(mat.$red-palette, 800);
$ts-typography: mat.define-typography-config(
  $font-family: 'Montserrat, "Segoe UI", "Helvetica Neue", Arial, sans-serif',
  $headline-1: mat.define-typography-level(44px, 52px, 800),
  $headline-2: mat.define-typography-level(36px, 44px, 800),
  $headline-3: mat.define-typography-level(28px, 34px, 700),
  $headline-4: mat.define-typography-level(22px, 30px, 700),
  $body-1: mat.define-typography-level(16px, 24px, 600),
  $body-2: mat.define-typography-level(14px, 22px, 600),
  $button: mat.define-typography-level(14px, 20px, 700)
);

$ts-theme: mat.define-light-theme((
  color: (
    primary: $ts-primary,
    accent: $ts-accent,
    warn: $ts-warn,
  ),
  typography: $ts-typography,
  density: 0,
));

/* Dark theme for Material */
$ts-dark-primary: mat.define-palette(mat.$red-palette, 500, 400, 600);
$ts-dark-accent: mat.define-palette(mat.$amber-palette, 500, 400, 600);
$ts-dark-warn: mat.define-palette(mat.$red-palette, 600);

$ts-dark-theme: mat.define-dark-theme((
  color: (
    primary: $ts-dark-primary,
    accent: $ts-dark-accent,
    warn: $ts-dark-warn,
  ),
  typography: $ts-typography,
  density: 0,
));

@include mat.all-component-themes($ts-theme);
@include mat.all-component-typographies($ts-theme);

/* Dark mode theme overrides */
:root.dark-mode {
  @include mat.all-component-colors($ts-dark-theme);
}

/* Force slide toggle primary color (red) instead of accent (amber) */
.mat-mdc-slide-toggle.mat-primary {
  --mdc-switch-selected-track-color: #d71920;
  --mdc-switch-selected-handle-color: #d71920;
  --mdc-switch-selected-hover-track-color: #b31218;
  --mdc-switch-selected-hover-handle-color: #b31218;
  --mdc-switch-selected-focus-track-color: #d71920;
  --mdc-switch-selected-focus-handle-color: #d71920;
  --mdc-switch-selected-pressed-track-color: #b31218;
  --mdc-switch-selected-pressed-handle-color: #b31218;
}

:root.dark-mode .mat-mdc-slide-toggle.mat-primary {
  --mdc-switch-selected-track-color: #ff4444;
  --mdc-switch-selected-handle-color: #ff4444;
  --mdc-switch-selected-hover-track-color: #dd3333;
  --mdc-switch-selected-hover-handle-color: #dd3333;
  --mdc-switch-selected-focus-track-color: #ff4444;
  --mdc-switch-selected-focus-handle-color: #ff4444;
  --mdc-switch-selected-pressed-track-color: #dd3333;
  --mdc-switch-selected-pressed-handle-color: #dd3333;
}

* {
  box-sizing: border-box;
}

html, body {
  height: 100%;
  background: var(--ts-page-bg);
}

body {
  margin: 0;
  font-family: 'Montserrat', 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
  color: var(--ts-ink);
  -webkit-font-smoothing: antialiased;
}

a {
  color: var(--ts-red);
  font-weight: 600;
  text-decoration: none;
}

a:hover,
a:focus-visible {
  text-decoration: underline;
}

button:focus-visible,
a:focus-visible {
  outline: 3px solid var(--ts-amber);
  outline-offset: 2px;
}

app-root {
  display: block;
  min-height: 100vh;
}

/* Dark mode readability enhancements across common components */
:root.dark-mode {
  /* Base text and surfaces */
  body { color: var(--ts-ink); background: var(--ts-page-bg); }
  .mat-mdc-card, mat-card { background: var(--ts-surface-secondary); color: var(--ts-ink); }
  .mat-mdc-list, mat-list { background: transparent; color: var(--ts-ink); }
  .mat-mdc-table, table { background: var(--ts-surface-secondary); color: var(--ts-ink); }
  .mat-mdc-form-field { color: var(--ts-ink); }
  .mdc-text-field__input { color: var(--ts-ink) !important; }
  .mat-mdc-form-field-focus-overlay { background-color: transparent; }
  .mat-mdc-form-field-subscript-wrapper { color: var(--ts-ink-secondary); }
  .mat-mdc-input-element::placeholder { color: var(--ts-ink-secondary); opacity: 0.8; }

  /* Dividers and borders */
  .mat-divider, mat-divider { border-color: var(--ts-border) !important; }
  .mat-mdc-card, mat-card { border: 1px solid var(--ts-border); }
  .mat-mdc-table .mdc-data-table__header-row { border-bottom: 1px solid var(--ts-border); }
  .mat-mdc-table .mdc-data-table__row { border-bottom: 1px solid var(--ts-border); }

  /* Buttons */
  .mat-mdc-button, .mat-mdc-raised-button, .mat-mdc-stroked-button, .mat-mdc-flat-button {
    color: var(--ts-ink);
  }
  .mat-mdc-stroked-button { border-color: var(--ts-border); }
  .mat-mdc-raised-button, .mat-mdc-flat-button { background: var(--ts-surface); }

  /* Menu and overlays */
  .mat-mdc-menu-panel, .cdk-overlay-pane .mat-mdc-menu-panel { background: var(--ts-surface-secondary); color: var(--ts-ink); }
  .cdk-overlay-backdrop { background: var(--ts-overlay-bg); }

  /* Chips and badges */
  .mat-mdc-chip { background: var(--ts-surface); color: var(--ts-ink); }
  .mat-badge-content { background: var(--ts-red); color: #fff; }

  /* Tabs */
  .mat-mdc-tab-group { color: var(--ts-ink); }
  .mat-mdc-tab-header { border-bottom: 1px solid var(--ts-border); }
  .mat-mdc-tab.mdc-tab--active .mdc-tab__text-label { color: var(--ts-red); }
}

/* Material Icons font configuration */
.material-icons,
.mat-icon,
mat-icon {
  font-family: 'Material Icons' !important;
  font-weight: normal;
  font-style: normal;

/* Invoice view print + responsive tweaks (moved out of component to reduce bundle) */
@media print {
  .invoice-view-container {
    padding: 0;
    background: #fff;

    .invoice-header { display: none; }

    .invoice-content {
      display: block;
      gap: 0;

      .invoice-sidebar { display: none; }
      .invoice-document { padding: 0; box-shadow: none; }
    }
  }
}

@media (max-width: 1024px) {
  .invoice-view-container .invoice-content { grid-template-columns: 1fr; }
  .invoice-view-container .invoice-sidebar .sidebar-card {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    background: #fff;
    padding: 0;
  }
  .invoice-view-container .invoice-sidebar .sidebar-card mat-card-content { padding: 12px; }
}

@media (max-width: 768px) {
  .invoice-view-container { padding: 12px; }
  .invoice-view-container .invoice-header .header-left { flex-direction: column; width: 100%; }
  .invoice-view-container .invoice-header .header-actions { width: 100%; }

  .invoice-view-container .invoice-content .invoice-document { padding: 20px; }
  .invoice-view-container .invoice-content .invoice-document .company-header { flex-direction: column; gap: 20px; }
  .invoice-view-container .invoice-content .invoice-document .invoice-title-date { text-align: left; }
  .invoice-view-container .invoice-content .invoice-document .invoice-title-date h1 { font-size: 24px; }
  .invoice-view-container .invoice-content .invoice-document .invoice-meta .meta-row { justify-content: flex-start; }

  .invoice-view-container .invoice-content .line-items-table { font-size: 12px; }
  .invoice-view-container .invoice-content .line-items-table thead { display: none; }
  .invoice-view-container .invoice-content .line-items-table tbody { display: block; }
  .invoice-view-container .invoice-content .line-items-table tbody tr {
    display: block;
    margin-bottom: 16px;
    border: 1px solid var(--border-color);
    border-radius: var(--radius-sm);
    overflow: hidden;
  }
  .invoice-view-container .invoice-content .line-items-table tbody tr td {
    display: flex;
    justify-content: space-between;
    padding: 8px;
    border-bottom: 1px solid var(--border-color);
  }
  .invoice-view-container .invoice-content .line-items-table tbody tr td::before { content: attr(data-label); font-weight: 600; }
  .invoice-view-container .invoice-content .line-items-table tbody tr td:last-child { border-bottom: none; }

  .invoice-view-container .invoice-content .totals-section { flex-direction: column; gap: 20px; }
  .invoice-view-container .invoice-content .totals-right { flex: 1; width: 100%; }

  .invoice-view-container .invoice-sidebar { flex-direction: row; gap: 12px; }
  .invoice-view-container .invoice-sidebar .sidebar-card { flex: 1; min-width: 150px; }
}
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  display: inline-block;
  width: 24px;
  height: 24px;
  vertical-align: middle;
  overflow: visible !important;
  flex-shrink: 0;
}

/* Material Icon sizing constraints removal */
.mat-icon {
  min-width: 24px !important;
  min-height: 24px !important;
  max-width: none !important;
  max-height: none !important;
}

/* Button styles - ensure icons display properly */
button,
button .mdc-button__ripple,
button .mdc-button__focus-ring,
.mat-mdc-button,
.mat-mdc-stroked-button,
.mat-mdc-flat-button,
.mat-mdc-raised-button {
  overflow: visible !important;
}

/* Button icon positioning */
button .mat-icon,
[mat-button] .mat-icon,
.mat-mdc-button .mat-icon,
.mat-mdc-stroked-button .mat-icon,
.mat-mdc-flat-button .mat-icon,
.mat-mdc-raised-button .mat-icon {
  display: inline-block;
  margin-right: 8px;
  overflow: visible !important;
}

/* Menu item styles */
.mat-mdc-menu-item,
.mat-mdc-menu-item .mdc-list-item__content {
  overflow: visible !important;
}

/* Menu item icon positioning */
.mat-mdc-menu-item .mat-icon {
  display: inline-block;
  margin-right: 8px;
  overflow: visible !important;
}

/* List item icon positioning */
.mat-mdc-list-item .mat-icon,
[mat-list-item] .mat-icon {
  display: inline-block;
  margin-right: 16px;
  overflow: visible !important;
}

/* Utility classes */
.muted {
  color: var(--ts-stone);
  font-weight: 600;
}

/* Layout helpers */
.page {
  display: grid;
  gap: var(--ts-spacing-xl);
}

.page__header {
  display: flex;
  align-items: flex-start;
  gap: var(--ts-spacing-lg);
  flex-wrap: wrap;
  justify-content: space-between;
}

.cta-group {
  display: inline-flex;
  gap: var(--ts-spacing-sm);
  flex-wrap: wrap;
}

/* Admin Dashboard Dark Mode Enhancements */
:root.dark-mode {
  /* Admin container and general */
  .admin-container {
    background: var(--ts-page-bg);
    color: var(--ts-ink);
  }

  /* Admin tabs */
  .admin-tabs .mat-mdc-tab-header {
    border-bottom-color: var(--ts-border);
  }
  .admin-tabs .mat-mdc-tab.mdc-tab--active .mdc-tab__text-label {
    color: var(--ts-red);
  }
  .admin-tabs .mat-mdc-tab:not(.mdc-tab--active) .mdc-tab__text-label {
    color: var(--ts-ink-secondary);
  }

  /* Settings and info cards */
  .settings-card {
    background: var(--ts-surface-secondary);
    border-color: var(--ts-border);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  }
  .settings-card mat-card-header {
    background: var(--ts-surface);
    border-bottom-color: var(--ts-border);
  }
  .settings-card mat-card-title {
    color: var(--ts-ink);
  }
  .settings-card mat-card-content {
    color: var(--ts-ink);
  }

  /* Users card */
  .users-card {
    background: var(--ts-surface-secondary);
    border-color: var(--ts-border);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  }
  .users-card mat-card-header {
    background: var(--ts-surface);
    border-bottom-color: var(--ts-border);
  }
  .users-card mat-card-title {
    color: var(--ts-ink);
  }

  /* Form fields */
  .settings-card .mat-mdc-form-field,
  .users-card .mat-mdc-form-field {
    color: var(--ts-ink);
  }
  .settings-card .mdc-text-field,
  .users-card .mdc-text-field {
    background: var(--ts-surface);
  }
  .settings-card .mdc-text-field__input,
  .users-card .mdc-text-field__input {
    color: var(--ts-ink) !important;
  }
  .settings-card .mdc-text-field__input::placeholder,
  .users-card .mdc-text-field__input::placeholder {
    color: var(--ts-ink-secondary);
    opacity: 0.7;
  }
  .settings-card .mdc-notched-outline__leading,
  .users-card .mdc-notched-outline__leading,
  .settings-card .mdc-notched-outline__notch,
  .users-card .mdc-notched-outline__notch,
  .settings-card .mdc-notched-outline__trailing,
  .users-card .mdc-notched-outline__trailing {
    border-color: var(--ts-border) !important;
  }

  /* Tables */
  .users-table {
    background: var(--ts-surface-secondary);
    color: var(--ts-ink);
  }
  .users-table thead {
    background: var(--ts-surface);
  }
  .users-table th {
    background: var(--ts-surface);
    color: var(--ts-ink);
    border-bottom-color: var(--ts-border);
  }
  .users-table td {
    border-bottom-color: var(--ts-border);
    color: var(--ts-ink);
  }
  .users-table tr:hover {
    background: rgba(255, 255, 255, 0.05);
  }

  /* Badges and status indicators */
  .role-badge,
  .status-badge {
    border-color: var(--ts-border);
  }
  .role-superadmin {
    background: rgba(255, 180, 77, 0.2);
    color: var(--ts-amber);
  }
  .role-broker {
    background: rgba(76, 175, 80, 0.2);
    color: var(--ts-green);
  }
  .role-carrier {
    background: rgba(76, 175, 80, 0.2);
    color: var(--ts-green);
  }
  .status-badge.active {
    background: rgba(38, 212, 142, 0.2);
    color: var(--ts-green);
  }
  .status-badge.inactive {
    background: rgba(255, 68, 68, 0.2);
    color: var(--ts-red);
  }

  /* Dividers */
  .admin-container mat-divider,
  .settings-card mat-divider,
  .users-card mat-divider {
    border-top-color: var(--ts-border);
  }

  /* Info rows */
  .info-row {
    border-bottom-color: var(--ts-border);
  }

  /* Action buttons */
  .action-btn {
    color: var(--ts-red);
  }
  .delete-action {
    color: var(--ts-red) !important;
  }

  /* Menu panels */
  .mat-mdc-menu-panel {
    background: var(--ts-surface-secondary);
    color: var(--ts-ink);
  }
  .mat-mdc-menu-item {
    color: var(--ts-ink);
  }
  .mat-mdc-menu-item:hover {
    background: rgba(255, 255, 255, 0.05);
  }

  /* Dialog overrides for admin components */
  .mat-mdc-dialog-container {
    background: var(--ts-surface-secondary);
    color: var(--ts-ink);
  }
  .mat-mdc-dialog-title {
    color: var(--ts-ink);
  }

  /* Slide toggle in admin */
  .ts-toggle.mat-mdc-slide-toggle.mat-primary {
    --mdc-switch-selected-track-color: var(--ts-red);
    --mdc-switch-selected-handle-color: var(--ts-red);
  }

  /* System information card */
  .info-row {
    color: var(--ts-ink);
  }
  .info-row .label {
    color: var(--ts-ink-secondary);
  }
  .info-row .value {
    color: var(--ts-ink);
  }
  .status-active {
    color: var(--ts-green) !important;
  }
  .status-active mat-icon {
    color: var(--ts-green) !important;
  }

  /* Users card header and content */
  .users-card mat-card-header {
    background: var(--ts-surface);
    border-bottom-color: var(--ts-border);
  }
  .users-card mat-card-title {
    color: var(--ts-ink);
  }
  .users-card mat-card-title mat-icon {
    color: var(--ts-red);
  }
  .users-card .add-user-btn {
    color: var(--ts-ink);
  }

  /* Material Data Table Headers in dark mode */
  .mat-mdc-header-row,
  .mdc-data-table__header-row {
    background: var(--ts-surface);
    border-bottom: 2px solid var(--ts-border);
  }

  .mat-mdc-header-cell,
  .mdc-data-table__header-cell {
    background: var(--ts-surface) !important;
    color: var(--ts-ink) !important;
    border-bottom: 2px solid var(--ts-border) !important;
    font-weight: 600;
    letter-spacing: 0.5px;
    padding: 16px 24px !important;
  }

  /* Specific column headers */
  .mat-column-email,
  .mat-column-name,
  .mat-column-role,
  .mat-column-status,
  .mat-column-lastLogin,
  .mat-column-actions {
    color: var(--ts-ink) !important;
  }

  /* Table rows in dark mode */
  .mat-mdc-row,
  .mdc-data-table__row {
    background: var(--ts-surface-secondary) !important;
    border-bottom: 1px solid var(--ts-border) !important;
  }

  .mat-mdc-row:hover,
  .mdc-data-table__row:hover {
    background: rgba(255, 255, 255, 0.05) !important;
  }

  .mat-mdc-cell,
  .mdc-data-table__cell {
    color: var(--ts-ink) !important;
    padding: 16px 24px !important;
  }
}
